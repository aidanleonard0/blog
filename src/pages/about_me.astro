---
import AuthorCard from '@/components/AuthorCard.astro'
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import Link from '@/components/Link.astro'
import PageHead from '@/components/PageHead.astro'
import ProjectCard from '@/components/ProjectCard.astro'
import Layout from '@/layouts/Layout.astro'
import { getAllProjects } from '@/lib/data-utils'

import BlogCard from '@/components/BlogCard.astro'
import { getAllAuthors, getPostsByAuthor } from '@/lib/data-utils'
const authors = await getAllAuthors()
const author = authors.find(a => a.id === "aidan")

if (!author) {
  throw new Error("Author not found")
}

const projects = await getAllProjects()
const authorPosts = await getPostsByAuthor('aidan')

const favouritePosts = authorPosts.filter(
  (post) => post.data.favourite
);
---

<Layout class="max-w-3xl">
  <PageHead slot="head" title="About" />
  <Breadcrumbs items={[{ label: 'about_me', icon: 'lucide:user' }]} />
  <section class="space-y-10">
    <h1 class="text-6xl leading-none font-bold text-center">About Me<h1>
    <AuthorCard author={author} />
  </section>
  <section class="flex flex-col gap-y-4 mt-2">
    <h2 class="text-2xl font-medium">My Favourite Posts</h2>
    {
  favouritePosts.length > 0 ? (
    <ul class="flex flex-col gap-4">
      {favouritePosts.map((post) => (
        <li>
          <BlogCard entry={post} />
        </li>
      ))}
    </ul>
  ) : (
    <p class="text-muted-foreground">
      No favourite posts :(
    </p>
  )
}
  </section>
  <section class="mt-2">
    <div class="min-w-full">
      <!-- <div class="prose mb-8">
        <p class="mt-0">

        </p>
      </div> -->
      <h2 class="mb-4 text-2xl font-medium">Cool Projects</h2>
      {projects.length > 0 ? (
        
        <div class="flex flex-col gap-4">
          {projects.map((project) => <ProjectCard project={project} />)}
        </div>
      ) : (
        <p class="text-center font-thin text-sm text-muted-foreground p-5">Coming soon...</p>
        )
      }

    </div>
  </section>
</Layout>
